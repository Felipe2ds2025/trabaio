<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Postar Capítulo - MangaZone</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
<style>
body {
background: url("https://wallpapers.com/images/hd/manga-pages-wfgb2o3h02vdszf2.jpg");
color: #ff1a1a;
}
.card-main{ background: rgb(0, 0, 0); border:1px solid #330000; color: #ff1a1a; }
.form-label{ color:#ff1a1a; }
.btn-custom{ background:#ff1a1a; color:#fff; border:none }
.btn-custom:disabled{ opacity:0.6 }
.file-grid{ display:grid; grid-template-columns: repeat(auto-fill,minmax(140px,1fr)); gap:12px }
.file-box{ background:#0b0b0b; padding:8px; border-radius:8px; border:1px dashed #330000; color:#ff1a1a }
.top-bar{ background: #000; padding:12px 20px; color:#ff1a1a; font-weight:bold; font-size:1.2rem; }
input, select, textarea{ background:#0b0b0b; color:#ff1a1a; border:1px solid #330000; }
input::placeholder, textarea::placeholder{ color:#ff6b6b; }
option{ background:#0b0b0b; color:#ff1a1a; }
</style>
</head>
<body>


<!-- Barra superior administrativa -->
<div class="top-bar">Administrativo - MangaZone</div>


<div class="container py-5">


<!-- Cards de informações -->
<div class="row mb-4 text-center">
<div class="col-md-4 mb-3">
<div class="card card-main p-3">
<h4 style="color:#ff1a1a">Capítulos Acessados</h4>
<p class="fs-4">1.254</p>
</div>
</div>
<div class="col-md-4 mb-3">
<div class="card card-main p-3">
<h4 style="color:#ff1a1a">Leituras Hoje</h4>
<p class="fs-4">389</p>
</div>
</div>
<div class="col-md-4 mb-3">
<div class="card card-main p-3">
<h4 style="color:#ff1a1a">Capítulos Pendentes</h4>
<p class="fs-4">12</p>
</div>
</div>
</div>

  <div class="container py-5">
    <h1 class="text-center mb-4" style="color:#ff1a1a">Postar Capítulo</h1>

    <div class="card card-main mx-auto p-4" style="max-width:900px">
      <!-- Single-column layout: informações obrigatórias em cima, upload de páginas abaixo -->
      <form id="postForm" class="needs-validation" novalidate>

        <div class="row g-3">
          <div class="col-12 col-md-6">
            <label class="form-label">Nome do Mangá *</label>
            <input id="nome" name="nome" type="text" class="form-control" required />
            <div class="invalid-feedback">Informe o nome do mangá.</div>
          </div>

          <div class="col-6 col-md-3">
            <label class="form-label">Capítulo Nº *</label>
            <input id="numero" name="numero" type="number" class="form-control" min="1" required />
            <div class="invalid-feedback">Informe o número do capítulo.</div>
          </div>

          <div class="col-6 col-md-3">
            <label class="form-label">Título do Capítulo *</label>
            <input id="titulo" name="titulo" type="text" class="form-control" required />
            <div class="invalid-feedback">Informe o título do capítulo.</div>
          </div>

          <div class="col-12">
            <label class="form-label">Descrição *</label>
            <textarea id="descricao" name="descricao" class="form-control" rows="2" required></textarea>
            <div class="invalid-feedback">Escreva uma descrição.</div>
          </div>

          <div class="col-6 col-md-4">
            <label class="form-label">Autor *</label>
            <input id="autor" name="autor" type="text" class="form-control" required />
            <div class="invalid-feedback">Informe o autor.</div>
          </div>

          <div class="col-6 col-md-4">
            <label class="form-label">Gênero *</label>
            <select id="genero" name="genero" class="form-select" required>
              <option value="">Selecione...</option>
              <option>Ação</option>
              <option>Aventura</option>
              <option>Fantasia</option>
              <option>Romance</option>
              <option>Comédia</option>
              <option>Drama</option>
              <option>Horror</option>
            </select>
            <div class="invalid-feedback">Escolha um gênero.</div>
          </div>

          <div class="col-12 col-md-4">
            <label class="form-label">Idade Recomendada *</label>
            <select id="idade" name="idade" class="form-select" required>
              <option value="">Selecione...</option>
              <option>Livre</option>
              <option>10+</option>
              <option>12+</option>
              <option>14+</option>
              <option>16+</option>
              <option>18+</option>
            </select>
            <div class="invalid-feedback">Selecione a idade recomendada.</div>
          </div>

          <!-- Seção de upload de páginas -->
          <div class="col-12">
            <hr style="border-color:#330000" />
            <label class="form-label">Quantas Páginas? *</label>
            <input id="qtPaginas" type="number" class="form-control mb-2" min="1" placeholder="Ex: 20" required />
            <div class="invalid-feedback" id="pagCountFeedback">Informe a quantidade de páginas.</div>

            <div id="uploaderArea">
              <!-- botão rápido para adicionar 1 página extra -->
              <div class="mb-2 d-flex gap-2">
                <button id="gerarBtn" type="button" class="btn btn-sm btn-custom">Gerar campos</button>
                <button id="limparBtn" type="button" class="btn btn-sm btn-outline-light">Limpar</button>
              </div>

              <div id="paginaGrid" class="file-grid" aria-live="polite"></div>

              <small class="d-block mt-2 text-muted">Cada campo aceita imagens (jpg, png). Todos são obrigatórios se você gerar com uma quantidade.</small>
            </div>
          </div>

        </div>

        <div class="mt-4 d-grid">
          <button id="submitBtn" class="btn btn-custom btn-lg" type="submit">Enviar e continuar</button>
        </div>

      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const form = document.getElementById('postForm');
    const qtPaginas = document.getElementById('qtPaginas');
    const gerarBtn = document.getElementById('gerarBtn');
    const limparBtn = document.getElementById('limparBtn');
    const paginaGrid = document.getElementById('paginaGrid');
    const pagCountFeedback = document.getElementById('pagCountFeedback');

    function clearPages(){
      paginaGrid.innerHTML = '';
    }

    function gerarCampos(){
      clearPages();
      const total = Number(qtPaginas.value);
      if (!total || total < 1){
        qtPaginas.classList.add('is-invalid');
        pagCountFeedback.textContent = 'Informe um número válido de páginas (>=1).';
        return;
      }
      qtPaginas.classList.remove('is-invalid');
      for (let i=1;i<=total;i++){
        const box = document.createElement('div');
        box.className = 'file-box';

        const lbl = document.createElement('label');
        lbl.className = 'form-label mb-1';
        lbl.textContent = `Página ${i} *`;

        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.required = true;
        input.className = 'form-control form-control-sm';
        input.dataset.page = i;

        box.appendChild(lbl);
        box.appendChild(input);
        paginaGrid.appendChild(box);
      }
      // scroll para os campos
      paginaGrid.scrollIntoView({behavior:'smooth', block:'center'});
    }

    gerarBtn.addEventListener('click', gerarCampos);
    limparBtn.addEventListener('click', ()=>{ qtPaginas.value=''; clearPages(); });

    // submit handler: valida todos os campos, inclusive arquivos gerados
    form.addEventListener('submit', function(e){
      // bootstrap validation
      if (!form.checkValidity()){
        e.preventDefault();
        e.stopPropagation();
        form.classList.add('was-validated');
        return;
      }

      // se há campos de páginas gerados, verificar se cada um tem arquivo
      const fileInputs = paginaGrid.querySelectorAll('input[type=file]');
      if (fileInputs.length > 0){
        for (const fi of fileInputs){
          if (!fi.files || fi.files.length === 0){
            e.preventDefault();
            e.stopPropagation();
            fi.classList.add('is-invalid');
            fi.scrollIntoView({behavior:'smooth', block:'center'});
            return;
          }
        }
      } else {
        // se não gerou campos, impedir envio
        e.preventDefault();
        e.stopPropagation();
        qtPaginas.classList.add('is-invalid');
        pagCountFeedback.textContent = 'Você precisa gerar os campos de upload para as páginas.';
        return;
      }

      // se passou em tudo: redireciona para a outra página (simulando envio bem sucedido)
      e.preventDefault(); // remover se quiser realmente submeter
      window.location.href = 'MangaZone.html';
    });

    // remover invalid ao preencher
    document.addEventListener('input', (ev)=>{
      const t = ev.target;
      if (t.classList.contains('is-invalid')) t.classList.remove('is-invalid');
      if (t === qtPaginas && t.value) qtPaginas.classList.remove('is-invalid');
    });
  </script>
</body>
</html>